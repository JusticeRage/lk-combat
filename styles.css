/* Bootstrap-first: keep overrides minimal and targeted */

.lk-body {
  background:
    radial-gradient(1200px 700px at 10% 0%, rgba(13,110,253,.18), transparent 55%),
    radial-gradient(900px 600px at 90% 0%, rgba(32,201,151,.14), transparent 55%),
    linear-gradient(180deg, var(--bs-body-bg), var(--bs-body-bg));
}

.lk-logo-wrap {
  max-width: 380px;
}

.lk-logo {
  width: 100%;
  height: auto;
  display: block;
}

.lk-stat-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap: .2rem .75rem;
  align-items: center;
}

.lk-stat-label {
  font-size: .75rem;
  letter-spacing: .06em;
  text-transform: uppercase;
  color: var(--bs-secondary-color);
  white-space: nowrap;
}

.lk-stat-value {
  font-weight: 700;
  font-variant-numeric: tabular-nums;
  white-space: nowrap;
}

.lk-hp {
  display: flex;
  flex-direction: column;
  gap: .35rem;
  min-width: 180px;
}

.lk-hp-head { display: flex; align-items: center; justify-content: space-between; }

.lk-hp-title {
  font-size: .8rem;
  letter-spacing: .08em;
  text-transform: uppercase;
  color: var(--bs-secondary-color);
}

.lk-hp-num {
  font-weight: 700;
  font-variant-numeric: tabular-nums;
  white-space: nowrap;
}

.lk-hp .progress { height: .45rem; border-radius: 999px; background: var(--bs-tertiary-bg); }
.lk-hp .progress-bar { border-radius: 999px; }

.lk-table {
  border: 1px solid var(--bs-border-color);
  border-radius: .9rem;
  overflow: hidden;
  background: var(--bs-body-bg);
}

.lk-table.table-responsive { overflow: auto; }

.lk-table table {
  width: 100%;
  margin: 0;
  border-collapse: collapse;
}

.lk-table thead { background: var(--bs-tertiary-bg); }

.lk-table th,
.lk-table td {
  padding: .75rem;
  border-bottom: 1px solid var(--bs-border-color);
  vertical-align: middle;
}

.lk-table th { font-weight: 700; white-space: nowrap; }
.lk-table tbody tr:last-child td { border-bottom: none; }

.lk-actions-col { width: 96px; text-align: right; white-space: nowrap; }
.lk-actions { display: inline-flex; justify-content: flex-end; gap: .35rem; width: 100%; }

.lk-icon-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 2.35rem;
  height: 2.35rem;
  padding: 0;
}

.lk-equip-switch { margin: 0; display: flex; align-items: center; justify-content: center; gap: .35rem; }
.lk-equip-switch .form-check-input { width: 2.6em; height: 1.3em; }
.lk-equip-switch .form-check-label { margin: 0; color: var(--bs-secondary-color); font-size: .88rem; }

.lk-badge { font-weight: 700; letter-spacing: .02em; }

.lk-details { background: color-mix(in oklab, var(--bs-tertiary-bg) 65%, transparent); }
.lk-details summary { cursor: pointer; color: var(--bs-secondary-color); font-weight: 700; }
.lk-details__inner { padding: .5rem .75rem; border-radius: .5rem; border: 1px dashed var(--bs-border-color); }
.lk-details__body { display: grid; gap: .25rem; margin-top: .35rem; }
.lk-details__row { font-size: .9rem; color: var(--bs-secondary-color); }

.lk-pill {
  font-weight: 600;
  padding: .5rem .6rem;
}

/* Log area */
.lk-log {
  height: 520px;
  overflow: auto;
  white-space: pre-wrap;
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
  font-size: 12px;
  line-height: 1.35;
  padding: .75rem;
  border: 1px solid var(--bs-border-color);
  border-radius: .75rem;
  background: var(--bs-tertiary-bg);
}

.lk-dice-row {
  display: flex;
  flex-wrap: wrap;
  gap: .5rem;
}

.lk-roll-group { display: flex; flex-direction: column; gap: .35rem; margin-bottom: .5rem; }
.lk-roll-label { font-weight: 600; color: var(--bs-secondary-color); letter-spacing: .02em; }

.lk-die {
  border: 2px solid var(--bs-border-color);
  border-radius: .65rem;
  width: 56px;
  height: 56px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: .35rem;
  background: var(--bs-body-bg);
  box-shadow: var(--lk-shadow-sm);
}

.lk-die img { width: 100%; height: 100%; }

.lk-die.is-success {
  border-color: var(--bs-success-border-subtle);
  box-shadow: 0 0 0 3px color-mix(in oklab, var(--bs-success-bg-subtle) 80%, transparent);
}

/* Textarea in import modal */
.lk-textarea {
  min-height: 220px;
  resize: vertical;
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
  font-size: 12px;
}

.lk-code-layout {
  display: grid;
  grid-template-columns: minmax(220px, 260px) 1fr;
  gap: 1rem;
  align-items: flex-start;
}

.lk-code-tabs {
  display: flex;
  flex-direction: column;
  gap: .75rem;
}

.lk-code-tab {
  border: 1px solid var(--bs-border-color);
  border-radius: .85rem;
  padding: .85rem 1rem;
  background: var(--bs-body-bg);
  box-shadow: var(--lk-shadow-sm);
  display: grid;
  gap: .25rem;
  min-width: 240px;
  text-align: left;
  transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease;
}

.lk-code-tab:hover { transform: translateY(-1px); }
.lk-code-tab.is-active {
  border-color: var(--bs-primary-border-subtle);
  box-shadow: 0 .45rem 1.2rem rgba(0,0,0,.08);
}
.lk-code-tab.is-active .lk-code-tab__title { color: var(--bs-primary); }

.lk-code-tab__title { font-weight: 700; margin: 0; }
.lk-code-tab__subtitle { margin: 0; color: var(--bs-secondary-color); font-size: .9rem; }

.lk-code-grid {
  display: grid;
  grid-template-columns: repeat(10, minmax(60px, 1fr));
  gap: .5rem;
}

.lk-map-layout {
  display: grid;
  grid-template-columns: minmax(220px, 260px) 1fr;
  gap: 1rem;
  align-items: flex-start;
}

.lk-map-tabs {
  display: flex;
  flex-direction: column;
  gap: .75rem;
}

.lk-map-viewer {
  display: flex;
  flex-direction: column;
  gap: .75rem;
}

.lk-map-canvas {
  border: 1px solid var(--bs-border-color);
  border-radius: .85rem;
  background: color-mix(in oklab, var(--bs-body-bg) 80%, var(--bs-tertiary-bg) 20%);
  box-shadow: var(--lk-shadow-sm);
  padding: .75rem;
  overflow: auto;
  min-height: 320px;
  max-height: 70vh;
  touch-action: none;
  cursor: grab;
}

.lk-map-image {
  display: block;
  max-width: none;
  width: 100%;
  height: auto;
}

.lk-code-cell {
  display: inline-flex;
  align-items: center;
  gap: .35rem;
  padding: .35rem .5rem;
  border: 1px solid var(--bs-border-color);
  border-radius: .65rem;
  background: color-mix(in oklab, var(--bs-tertiary-bg) 65%, transparent);
  box-shadow: var(--lk-shadow-sm);
  font-weight: 600;
}

.lk-code-cell.form-check {
  padding-left: .5rem;
}

.lk-code-cell .form-check-input {
  margin-left: 0;
  margin-top: 0;
  float: none;
}

.lk-code-label { font-variant-numeric: tabular-nums; }

/* Slightly sharper cards */
.card { border-radius: 1rem; }
.card-header { border-top-left-radius: 1rem !important; border-top-right-radius: 1rem !important; }

/* Mobile tweaks */
@media (max-width: 575.98px) {
  .lk-log { height: 360px; }
}

@media (max-width: 991.98px) {
  .lk-code-layout {
    grid-template-columns: 1fr;
  }

  .lk-code-tabs {
    flex-direction: row;
    flex-wrap: wrap;
  }

  .lk-map-layout {
    grid-template-columns: 1fr;
  }

  .lk-map-tabs {
    flex-direction: row;
    flex-wrap: wrap;
  }
}

/* -----------------------------
   Party management: portrait rail + sheet
-------------------------------- */

.lk-party-editor {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.lk-shared-layout {
  display: flex;
  flex-direction: column;
  gap: 1rem;
  align-items: stretch;
}

.lk-vault-panel {
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  gap: .75rem;
}

.lk-mission-panel {
  flex: 0 0 22%;
  max-width: 320px;
  min-width: min(320px, 100%);
  display: flex;
  flex-direction: column;
}

.lk-vault-input { min-width: 260px; }

.lk-vault-list {
  border: 1px solid var(--bs-border-color);
  border-radius: .9rem;
  padding: .75rem;
  display: flex;
  flex-direction: column;
  gap: .5rem;
  background: color-mix(
    in oklab,
    var(--bs-body-bg) 70%,
    var(--bs-tertiary-bg) 30%
  );
}


.lk-vault-item {
  display: grid;
  grid-template-columns: 1fr auto;
  align-items: center;
  gap: .5rem;
  padding: .5rem .65rem;
  border-radius: .65rem;
  border: 1px solid var(--bs-border-color);
  background: color-mix(in oklab, var(--bs-tertiary-bg) 60%, transparent);
}

.lk-vault-name { font-weight: 600; }
.lk-vault-actions { display: flex; gap: .35rem; }

.lk-vault-empty {
  color: var(--bs-secondary-color);
  font-size: .95rem;
}

.lk-mission-notes {
  width: 100%;
  flex: 1;
  min-height: 240px;
  resize: vertical;
}

@media (min-width: 992px) {
  .lk-shared-layout { flex-direction: row; }
}

.lk-party-shell {
  display: grid;
  grid-template-columns: minmax(220px, 260px) 1fr;
  gap: 1rem;
  align-items: start;
}

.lk-portrait-rail {
  display: flex;
  flex-direction: column;
  gap: .75rem;
  padding: .25rem;
  background: color-mix(in oklab, var(--bs-tertiary-bg) 70%, transparent);
  border: 1px solid var(--bs-border-color);
  border-radius: 1rem;
}

.lk-portrait-tab {
  display: grid;
  grid-template-columns: 64px 1fr;
  align-items: center;
  gap: .65rem;
  width: 100%;
  padding: .65rem;
  background: var(--bs-body-bg);
  border: 1px solid var(--bs-border-color);
  border-radius: .85rem;
  box-shadow: var(--lk-shadow-sm);
  transition: border-color .15s ease, background-color .15s ease, transform .15s ease;
}

.lk-portrait-tab:hover { transform: translateY(-1px); }
.lk-portrait-tab.is-active { border-color: var(--bs-primary-border-subtle); box-shadow: 0 .45rem 1.2rem rgba(0,0,0,.08); }
.lk-portrait-tab.is-active .lk-portrait-name { color: var(--bs-primary); }

.lk-portrait-thumb {
  width: 64px;
  height: 64px;
  border-radius: .85rem;
  object-fit: cover;
}

.lk-portrait-name { font-weight: 700; margin: 0; }
.lk-portrait-hp {
  display: flex;
  flex-direction: column;
  gap: .25rem;
}

.lk-portrait-hp-head { display: flex; align-items: center; justify-content: space-between; gap: .5rem; }
.lk-portrait-hp-title {
  font-size: .75rem;
  letter-spacing: .08em;
  text-transform: uppercase;
  color: var(--bs-secondary-color);
}

.lk-portrait-hp-num {
  font-weight: 700;
  font-variant-numeric: tabular-nums;
}

.lk-portrait-hp .progress { height: .35rem; border-radius: 999px; background: var(--bs-tertiary-bg); }
.lk-portrait-hp .progress-bar { border-radius: 999px; }

.lk-party-sheet {
  border: 1px solid var(--bs-border-color);
  border-radius: 1rem;
  box-shadow: 0 .65rem 1.6rem rgba(0,0,0,.06);
  background: var(--bs-body-bg);
}

.lk-sheet__header { padding: 1.25rem 1.25rem 0 1.25rem; }
.lk-sheet__body { padding: 1.25rem; display: grid; gap: 1.25rem; }

.lk-sheet__cta { display: flex; flex-wrap: wrap; gap: .5rem; justify-content: flex-end; }

.lk-sheet__grid {
  display: grid;
  gap: 1.2rem;
  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
}

.lk-section {
  padding: 1rem;
  border: 1px dashed color-mix(in oklab, var(--bs-border-color) 60%, transparent);
  border-radius: .9rem;
  background: color-mix(in oklab, var(--bs-tertiary-bg) 60%, transparent);
  box-shadow: inset 0 1px 0 rgba(255,255,255,.4);
  display: flex;
  flex-direction: column;
  gap: .75rem;
  min-height: 0;
}

.lk-section--wide {
  grid-column: 1 / -1;
}

.lk-section-heading { display: flex; align-items: center; justify-content: space-between; gap: .75rem; margin-bottom: .65rem; }
.lk-section-title { margin: 0; font-size: .95rem; letter-spacing: .02em; text-transform: uppercase; color: var(--bs-secondary-color); }

.equipment-stack { display: flex; flex-direction: column; gap: .75rem; }
.equip-row { border: 1px solid var(--bs-border-color); border-radius: .9rem; padding: .75rem; background: var(--bs-body-bg); box-shadow: var(--lk-shadow-sm); }
.equip-help { margin-top: .35rem; font-size: .9rem; color: var(--bs-secondary-color); }
.equipment-meta { margin-top: .35rem; }

.lk-notes {
  width: 100%;
  flex: 1;
  min-height: 220px;
  resize: vertical;
}

.lk-spell-table .form-label { font-size: .85rem; color: var(--bs-secondary-color); }
.lk-spell-table td:first-child,
.lk-spell-table th:first-child {
  min-width: 190px;
}

.lk-spell-table td:nth-child(2),
.lk-spell-table th:nth-child(2) {
  width: 120px;
  white-space: nowrap;
}

.lk-spell-table td:nth-child(3) {
  white-space: normal;
  word-break: break-word;
}
.spell-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: .5rem; align-items: center; }

.lk-empty-sheet { border: 1px dashed var(--bs-border-color); border-radius: 1rem; padding: 1.5rem; text-align: center; color: var(--bs-secondary-color); }

.lk-army-list { display: flex; flex-direction: column; gap: .75rem; }
.lk-army-row {
  border: 1px solid var(--bs-border-color);
  border-radius: .85rem;
  padding: 1rem;
  background: color-mix(in oklab, var(--bs-body-bg) 82%, var(--bs-tertiary-bg) 18%);
}
.lk-army-row .form-label { margin-bottom: .35rem; }

.lk-mass-grid { display: grid; grid-template-columns: repeat(3, minmax(0, 1fr)); gap: .75rem; }
.lk-mass-grid__cell { height: 100%; }
.lk-mass-grid__divider {
  grid-column: 1 / -1;
  display: flex;
  align-items: center;
  gap: .5rem;
  color: var(--bs-secondary-color);
  padding: .35rem 0;
}
.lk-mass-divider__line { flex: 1; border-top: 1px dashed var(--bs-border-color); }
.lk-mass-divider__label { font-size: .9rem; font-weight: 700; letter-spacing: .05em; text-transform: uppercase; }
.lk-mass-card {
  border: 1px solid var(--bs-border-color);
  border-radius: .85rem;
  padding: .75rem;
  height: 100%;
  position: relative;
  overflow: hidden;
  background: color-mix(in oklab, var(--bs-body-bg) 86%, var(--bs-tertiary-bg) 14%);
}
.lk-mass-card.is-active { border-color: var(--bs-danger); border-width: 2px; }
.lk-mass-card__head { display: flex; align-items: center; justify-content: space-between; gap: .5rem; }
.lk-mass-card.is-empty { border-style: dashed; color: var(--bs-secondary-color); background: var(--bs-body-bg); }
.lk-mass-card__name.is-routed { text-decoration: line-through; }
.lk-mass-card__name.is-routed::after { content: " \1F480"; }
.lk-mass-card.is-defeated::after {
  content: "";
  position: absolute;
  inset: 0;
  pointer-events: none;
  background-image: repeating-linear-gradient(
    -45deg,
    color-mix(in oklab, var(--bs-secondary-color) 55%, transparent 45%) 0,
    color-mix(in oklab, var(--bs-secondary-color) 55%, transparent 45%) 18px,
    transparent 18px,
    transparent 36px
  );
  opacity: .65;
}

@media (max-width: 991.98px) {
  .lk-party-shell { grid-template-columns: 1fr; }
  .lk-portrait-rail { flex-direction: row; flex-wrap: wrap; }
  .lk-portrait-tab { width: calc(50% - .5rem); }
}

@media (max-width: 575.98px) {
  .lk-portrait-tab { width: 100%; }
}

/* Dialog fallback styling (native <dialog>) */
.lk-dialog {
  position: fixed;
  border: none;
  border-radius: 1rem;
  padding: 0;
  box-shadow: 0 1.5rem 3rem rgba(0,0,0,.25);
  width: min(720px, 92vw);
  inset: 50% auto auto 50%;
  transform: translate(-50%, -50%);
  background: var(--bs-body-bg);
  color: var(--bs-body-color);
  z-index: 1080;
}

.lk-dialog::backdrop {
  background: rgba(15, 23, 42, .55);
}

.lk-shared-section {
  display: flex;
  flex-direction: column;
  gap: .75rem;
}

.lk-shared-section--notes {
  flex: 1;
  min-height: 0;
}

.lk-shared-section--notes .lk-mission-notes {
  flex: 1;
  min-height: 240px;
  resize: none;
}

.lk-shared-head {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: .75rem;
  flex-wrap: wrap;
  margin-bottom: .25rem;
}

.lk-shared-mini {
  border: 1px solid var(--bs-border-color);
  border-radius: .85rem;
  padding: .75rem .9rem;
  background: var(--bs-body-bg);
  box-shadow: var(--lk-shadow-sm);
}

